{% extends "base.html" %}
{% block title %}{{ post.title }} - the Neurascape{% endblock %}

{% block content %}
<article class="single-post">
    <header class="post-header">
        <h1 class="post-title">{{ post.title }}</h1>
        <div class="post-meta">
            <span class="post-date">{{ post.date_posted.strftime('%B %d, %Y') }}</span>
            {% if post.project %}
            <span class="post-project">
                <i class="fa-solid fa-folder-open"></i>
                <a href="{{ url_for('projects') }}#project-{{ post.project.id }}">{{ post.project.title }}</a>
            </span>
            {% endif %}
        </div>
    </header>

    {% if post.image_filename %}
    <div class="post-image">
        <!-- Responsive image with srcset -->
        {% if USING_SPACES %}
        <img src="{{ SPACES_URL }}/medium/{{ post.image_filename }}"
             srcset="{{ get_srcset(post.image_filename) }}"
             sizes="(max-width: 600px) 100vw, (max-width: 1200px) 80vw, 800px"
             alt="{{ photo.description }}"
             class="post-feature-img"
             loading="eager">
        {% else %}
        <img src="{{ url_for('static', filename='images/medium/' + post.image_filename) }}"
             srcset="{{ get_srcset(post.image_filename) }}"
             sizes="(max-width: 600px) 100vw, (max-width: 1200px) 80vw, 800px"
             alt="{{ post.title }}"
             class="post-feature-img"
             loading="eager"> <!-- Load eagerly for above-the-fold image -->
        {% endif %}
    </div>
    {% endif %}

    <div class="post-content">
        {{ post.content|markdown_safe }}
    </div>

    {% if post.github_link %}
    <div class="post-links">
        <a href="{{ post.github_link }}" target="_blank" class="github-link">
            <i class="fa-brands fa-github"></i> View on GitHub
        </a>
    </div>
    {% endif %}

    <div class="post-navigation">
        <a href="{{ url_for('index') }}" class="back-link">
            <i class="fa-solid fa-arrow-left"></i> Back to all posts
        </a>
    </div>
</article>
{% endblock %}